<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Golf Range Visualizer</title>
    <style>
        body, html { margin:0; padding:0; width:100%; height:100%; overflow:hidden; }
        #container { width:100%; height:100%; }
        #ui { position:absolute; top:10px; left:10px; z-index:10; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.min.js"></script>
</head>
<body>
<div id="ui">
    <button id="start">Hit Ball</button>
</div>
<div id="container"></div>
<script>
const container = document.getElementById('container');
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 500);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
container.appendChild(renderer.domElement);

const groundGeo = new THREE.PlaneGeometry(200,200);
const groundMat = new THREE.MeshBasicMaterial({color:0x228B22});
const ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI/2;
scene.add(ground);

const ballGeo = new THREE.SphereGeometry(0.021,16,16);
const ballMat = new THREE.MeshBasicMaterial({color:0xffffff});
const ball = new THREE.Mesh(ballGeo, ballMat);
scene.add(ball);

camera.position.set(0,5,10);
const controls = {positions:[], idx:0};

function animate(){
    requestAnimationFrame(animate);
    if(controls.positions.length && controls.idx < controls.positions.length){
        const p = controls.positions[controls.idx];
        ball.position.set(p[0], p[1], p[2]);
        controls.idx += 1;
    }
    renderer.render(scene, camera);
}
animate();

document.getElementById('start').onclick = async () => {
    const res = await fetch('/simulate', {method:'POST', headers:{'Content-Type':'application/json'}, body:'{}'});
    const data = await res.json();
    controls.positions = data.positions;
    controls.idx = 0;
};
</script>
</body>
</html>
